<!-- templates/library/list.html: Library browsing page with filters and search -->
{% extends 'libraryApp/base.html' %}

{% block title %}Library{% endblock %}

{% block content %}
    <h1 class="text-3xl font-bold mb-6">Explore Our Legal Publications</h1>
    
    <!-- Search and Filters -->
    <form method="GET" class="mb-8 flex flex-wrap gap-4">
        {{ search_form.query }}
        <select name="category" class="border p-2">
            <option value="">All Categories</option>
            {% for cat in categories %}
                <option value="{{ cat.slug }}" {% if request.GET.category == cat.slug %}selected{% endif %}>{{ cat.name }}</option>
            {% endfor %}
        </select>
        <select name="access" class="border p-2">
            <option value="">All Access Types</option>
            {% for value, label in access_types %}
                <option value="{{ value }}" {% if request.GET.access == value %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>
        <button type="submit" class="btn">Filter</button>
    </form>
    
    <!-- Book Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for book in books %}
            <div class="card">
                {% if book.cover_image %}
                    <img src="{{ book.cover_image.url }}" alt="{{ book.title }}" class="w-full h-48 object-cover mb-4">
                {% endif %}
                <h2 class="text-xl font-semibold">{{ book.title }}</h2>
                <p class="text-gray-600">By {{ book.author }}</p>
                <p class="mb-4">{{ book.description|truncatewords:30 }}</p>
                <p class="font-bold">
                    {% if book.access_type == 'free' %}Free{% else %}${{ book.price }}{% endif %}
                </p>
                <a href="{% url 'book_detail' book.pk %}" class="btn mt-2">View Details</a>
            </div>
        {% empty %}
            <p>No books found. Try adjusting your filters.</p>
        {% endfor %}
    </div>
    
    <!-- Pagination -->
    {% if is_paginated %}
        <div class="mt-8 flex justify-center">
            {% if page_obj.has_previous %}
                <a href="?page={{ page_obj.previous_page_number }}" class="btn mr-2">Previous</a>
            {% endif %}
            <span>Page {{ page_obj.number }} of {{ paginator.num_pages }}</span>
            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}" class="btn ml-2">Next</a>
            {% endif %}
        </div>
    {% endif %}
{% endblock %}

